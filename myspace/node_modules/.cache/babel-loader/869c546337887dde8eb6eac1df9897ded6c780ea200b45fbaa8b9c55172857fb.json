{"ast":null,"code":"import ContentBase from '../components/ContentBase.vue';\nimport UserProfileInfo from '@/components/UserProfileInfo.vue';\nimport UserProfilePosts from '@/components/UserProfilePosts.vue';\nimport UserProfileWrite from '@/components/UserProfileWrite.vue';\nimport { reactive } from 'vue';\nimport { useRoute } from 'vue-router';\nimport $ from 'jquery';\nimport { useStore } from 'vuex';\nimport { computed } from 'vue';\nexport default {\n  name: \"UserProfileView\",\n  components: {\n    ContentBase,\n    UserProfileInfo,\n    UserProfilePosts,\n    UserProfileWrite\n  },\n  setup: () => {\n    const store = useStore();\n    const route = useRoute();\n    const userId = parseInt(route.params.userId);\n    // console.log(userId);\n    const user = reactive({});\n    const posts = reactive({});\n    $.ajax({\n      url: \"https://app165.acapp.acwing.com.cn/myspace/getinfo/\",\n      type: \"GET\",\n      data: {\n        user_id: userId\n      },\n      headers: {\n        'Authorization': \"Bearer \" + store.state.user.access\n      },\n      success: resp => {\n        user.id = resp.id;\n        user.username = resp.username;\n        user.photo = resp.photo;\n        user.followerCount = resp.followerCount;\n        user.is_followed = resp.is_followed;\n      }\n    });\n    $.ajax({\n      url: \"https://app165.acapp.acwing.com.cn/myspace/post/\",\n      type: \"GET\",\n      data: {\n        user_id: userId\n      },\n      headers: {\n        'Authorization': \"Bearer \" + store.state.user.access\n      },\n      success: resp => {\n        posts.posts = resp;\n      }\n    });\n    const is_me = computed(() => userId === store.state.user.id);\n    const follow = () => {\n      if (user.is_followed) return;\n      user.followerCount++;\n      user.is_followed = true;\n    };\n    const unfollow = () => {\n      if (!user.is_followed) return;\n      user.followerCount--;\n      user.is_followed = false;\n    };\n    const post_a_post = content => {\n      if (content.value === \"\") return;\n      posts.count++;\n      posts.posts.unshift({\n        id: posts.count,\n        userId: 1,\n        content: content.value\n      });\n    };\n    return {\n      user,\n      // 返回的必须是一个对象, 不然子组件没法接受\n      follow,\n      unfollow,\n      posts,\n      post_a_post,\n      userId,\n      is_me\n    };\n  }\n};","map":{"version":3,"names":["ContentBase","UserProfileInfo","UserProfilePosts","UserProfileWrite","reactive","useRoute","$","useStore","computed","name","components","setup","store","route","userId","parseInt","params","user","posts","ajax","url","type","data","user_id","headers","state","access","success","resp","id","username","photo","followerCount","is_followed","is_me","follow","unfollow","post_a_post","content","value","count","unshift"],"sources":["D:\\a.project.vscode\\项目\\vue\\myspace\\src\\views\\UserProfileView.vue"],"sourcesContent":["<template>\r\n    <ContentBase>\r\n        <div class=\"row\">\r\n            <div class=\"col-3\">\r\n                <UserProfileInfo @follow=\"follow\" @unfollow=\"unfollow\" :user=\"user\"/>\r\n                <UserProfileWrite v-if=\"is_me\" @post_a_post=\"post_a_post\"/>\r\n            </div>\r\n            <div class=\"col-9\">\r\n                <UserProfilePosts  :posts=\"posts\"/>\r\n            </div>\r\n        </div>\r\n    </ContentBase>\r\n</template>\r\n\r\n<script>\r\nimport ContentBase from '../components/ContentBase.vue'\r\nimport UserProfileInfo from '@/components/UserProfileInfo.vue';\r\nimport UserProfilePosts from '@/components/UserProfilePosts.vue'\r\nimport UserProfileWrite from '@/components/UserProfileWrite.vue';\r\nimport { reactive } from 'vue';\r\nimport { useRoute } from 'vue-router';\r\nimport $ from 'jquery'\r\nimport { useStore } from 'vuex';\r\nimport { computed } from 'vue';\r\n\r\nexport default {\r\n    \r\n    name : \"UserProfileView\",\r\n    components : {\r\n        ContentBase,\r\n        UserProfileInfo,\r\n        UserProfilePosts,\r\n        UserProfileWrite\r\n    },\r\n    setup : () => {\r\n        const store = useStore();\r\n        const route = useRoute();\r\n        const userId = parseInt(route.params.userId);\r\n        // console.log(userId);\r\n        const user = reactive({});\r\n        const posts = reactive({});\r\n\r\n        $.ajax({\r\n            url: \"https://app165.acapp.acwing.com.cn/myspace/getinfo/\",\r\n            type : \"GET\",\r\n            data : {\r\n                user_id : userId,\r\n            },\r\n            headers : {\r\n                'Authorization' : \"Bearer \" + store.state.user.access,\r\n            },\r\n            success : (resp) => {\r\n                user.id = resp.id;\r\n                user.username = resp.username;\r\n                user.photo = resp.photo;\r\n                user.followerCount = resp.followerCount;\r\n                user.is_followed = resp.is_followed; \r\n            },\r\n        })\r\n\r\n        $.ajax ({\r\n            url : \"https://app165.acapp.acwing.com.cn/myspace/post/\",\r\n            type : \"GET\",\r\n            data : {\r\n                user_id : userId,\r\n            },\r\n            headers : {\r\n                'Authorization' : \"Bearer \" + store.state.user.access,\r\n            },\r\n            success : (resp) => {\r\n                posts.posts = resp;\r\n            }\r\n        })\r\n\r\n        const is_me = computed(() => userId === store.state.user.id)\r\n\r\n        const follow = () => {\r\n            if (user.is_followed) return;\r\n            user.followerCount ++ ;\r\n            user.is_followed = true;\r\n        }\r\n\r\n        const unfollow = () => {\r\n            if (!user.is_followed) return ;\r\n            user.followerCount --;\r\n            user.is_followed = false;\r\n        }\r\n\r\n        const post_a_post = (content) => {\r\n            if (content.value === \"\") return;\r\n            posts.count ++;\r\n\r\n            posts.posts.unshift({\r\n                id : posts.count,\r\n                userId : 1,\r\n                content : content.value,\r\n            })\r\n            \r\n        }\r\n\r\n        return {\r\n            user,   // 返回的必须是一个对象, 不然子组件没法接受\r\n            follow,\r\n            unfollow,\r\n            posts,\r\n            post_a_post,\r\n            userId,\r\n            is_me,\r\n        }\r\n    }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n\r\n</style>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}