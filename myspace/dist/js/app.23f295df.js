(function(){"use strict";var e={5988:function(e,s,t){var o=t(5130),a=t(6768);function n(e,s,t,o,n,r){const l=(0,a.g2)("NavBar"),c=(0,a.g2)("router-view");return(0,a.uX)(),(0,a.CE)("div",null,[(0,a.bF)(l),((0,a.uX)(),(0,a.Wv)(c,{key:e.$route.fullPath}))])}t(5707);var r=t(4232);const l={class:"navbar navbar-expand-lg navbar-light bg-light"},c={class:"container"},u=(0,a.Lk)("button",{class:"navbar-toggler",type:"button","data-toggle":"collapse","data-target":"#navbarText","aria-controls":"navbarText","aria-expanded":"false","aria-label":"Toggle navigation"},[(0,a.Lk)("span",{class:"navbar-toggler-icon"})],-1),i={class:"collapse navbar-collapse",id:"navbarText"},p={class:"navbar-nav mr-auto mb-2 mb-lg-1"},d={class:"nav-item"},m={class:"nav-item"},f={key:0,class:"navbar-nav"},v={class:"nav-item"},w={class:"nav-item"},g={key:1,class:"navbar-nav"},k={class:"nav-item"},_={class:"nav-item"};function b(e,s,t,o,n,b){const h=(0,a.g2)("router-link");return(0,a.uX)(),(0,a.CE)("nav",l,[(0,a.Lk)("div",c,[(0,a.bF)(h,{class:"navbar-brand",to:{name:"HomeView"}},{default:(0,a.k6)((()=>[(0,a.eW)("Myspace")])),_:1}),u,(0,a.Lk)("div",i,[(0,a.Lk)("ul",p,[(0,a.Lk)("li",d,[(0,a.bF)(h,{class:"nav-link",to:{name:"HomeView"}},{default:(0,a.k6)((()=>[(0,a.eW)("首页")])),_:1})]),(0,a.Lk)("li",m,[(0,a.bF)(h,{class:"nav-link",to:{name:"UserListView"}},{default:(0,a.k6)((()=>[(0,a.eW)("好友列表")])),_:1})])]),e.$store.state.user.is_login?((0,a.uX)(),(0,a.CE)("ul",g,[(0,a.Lk)("li",k,[(0,a.bF)(h,{class:"nav-link",to:{name:"UserProfileView",params:{userId:e.$store.state.user.id}}},{default:(0,a.k6)((()=>[(0,a.eW)((0,r.v_)(e.$store.state.user.username),1)])),_:1},8,["to"])]),(0,a.Lk)("li",_,[(0,a.Lk)("a",{class:"nav-link",style:{cursor:"pointer"},onClick:s[0]||(s[0]=(...s)=>e.logout&&e.logout(...s))},"退出")])])):((0,a.uX)(),(0,a.CE)("ul",f,[(0,a.Lk)("li",v,[(0,a.bF)(h,{class:"nav-link",to:{name:"LoginView"}},{default:(0,a.k6)((()=>[(0,a.eW)("登录")])),_:1})]),(0,a.Lk)("li",w,[(0,a.bF)(h,{class:"nav-link",to:{name:"RegisterView"}},{default:(0,a.k6)((()=>[(0,a.eW)("注册")])),_:1})])]))])])])}var h=t(6587),y=t.n(h),L=t(782),C={name:"NavBar",setup:()=>{const e=(0,L.Pj)(),s=()=>{e.commit("logout")};return{logout:s,param:h.param}},components:{}},P=t(1241);const j=(0,P.A)(C,[["render",b]]);var x=j,U={name:"App",components:{NavBar:x}};const V=(0,P.A)(U,[["render",n]]);var E=V,A=t(1387);function B(e,s,t,o,n,r){const l=(0,a.g2)("ContentBase");return(0,a.uX)(),(0,a.Wv)(l,null,{default:(0,a.k6)((()=>[(0,a.eW)(" 首页 ")])),_:1})}const X={class:"container"},O={class:"card"},W={class:"card-body"};function I(e,s,t,o,n,r){return(0,a.uX)(),(0,a.CE)("div",X,[(0,a.Lk)("div",O,[(0,a.Lk)("div",W,[(0,a.RG)(e.$slots,"default",{},void 0,!0)])])])}var T={name:"ContentBase"};const F=(0,P.A)(T,[["render",I],["__scopeId","data-v-1ef3c134"]]);var K=F,R={name:"HomeView",components:{ContentBase:K}};const S=(0,P.A)(R,[["render",B]]);var H=S;const $=e=>((0,a.Qi)("data-v-0957a929"),e=e(),(0,a.jt)(),e),z={class:"row justify-content-md-center"},Q={class:"col-4"},J={class:"form-group"},D=$((()=>(0,a.Lk)("label",{for:"username"},"username",-1))),N=$((()=>(0,a.Lk)("small",{id:"usernameHelp",class:"form-text text-muted"},"输入注册的邮箱",-1))),q={class:"form-group"},G=$((()=>(0,a.Lk)("label",{for:"password"},"password",-1))),M={class:"err-message"},Y=$((()=>(0,a.Lk)("button",{type:"submit",class:"btn btn-primary"},"登录",-1)));function Z(e,s,t,n,l,c){const u=(0,a.g2)("ContentBase");return(0,a.uX)(),(0,a.Wv)(u,null,{default:(0,a.k6)((()=>[(0,a.Lk)("div",z,[(0,a.Lk)("div",Q,[(0,a.Lk)("form",{onSubmit:s[2]||(s[2]=(0,o.D$)(((...s)=>e.login&&e.login(...s)),["prevent"]))},[(0,a.Lk)("div",J,[D,(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":s[0]||(s[0]=s=>e.username=s),type:"text",class:"form-control",id:"username","aria-describedby":"emailHelp"},null,512),[[o.Jo,e.username]]),N]),(0,a.Lk)("div",q,[G,(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":s[1]||(s[1]=s=>e.password=s),type:"password",class:"form-control",id:"password"},null,512),[[o.Jo,e.password]]),(0,a.Lk)("div",M,(0,r.v_)(e.err_message),1)]),Y],32)])])])),_:1})}t(4114);var ee=t(144),se={name:"LoginView",components:{ContentBase:K},setup:()=>{const e=(0,L.Pj)();let s=(0,ee.KR)(""),t=(0,ee.KR)(""),o=(0,ee.KR)("");const a=()=>{o.value="",e.dispatch("login",{username:s.value,password:t.value,success:()=>{hs.push({name:"UserListView"})},error:()=>{o.value="用户名或密码错误"}})};return{username:s,password:t,err_message:o,login:a,store:e}}};const te=(0,P.A)(se,[["render",Z],["__scopeId","data-v-0957a929"]]);var oe=te;function ae(e,s,t,o,n,r){const l=(0,a.g2)("ContentBase");return(0,a.uX)(),(0,a.Wv)(l,null,{default:(0,a.k6)((()=>[(0,a.eW)(" 404 ")])),_:1})}var ne={name:"NotFindView",components:{ContentBase:K}};const re=(0,P.A)(ne,[["render",ae]]);var le=re;const ce=e=>((0,a.Qi)("data-v-2ded7786"),e=e(),(0,a.jt)(),e),ue={class:"row justify-content-md-center"},ie={class:"col-4"},pe={class:"form-group"},de=ce((()=>(0,a.Lk)("label",{for:"username"},"username",-1))),me=ce((()=>(0,a.Lk)("small",{id:"usernameHelp",class:"form-text text-muted"},"输入注册的邮箱",-1))),fe={class:"form-group"},ve=ce((()=>(0,a.Lk)("label",{for:"password"},"password",-1))),we={class:"err-message"},ge=ce((()=>(0,a.Lk)("label",{for:"password_confirm",style:{"margin-top":"5px"}},"confirm password",-1))),ke=ce((()=>(0,a.Lk)("button",{type:"submit",class:"btn btn-primary"},"登录",-1)));function _e(e,s,t,n,l,c){const u=(0,a.g2)("ContentBase");return(0,a.uX)(),(0,a.Wv)(u,null,{default:(0,a.k6)((()=>[(0,a.Lk)("div",ue,[(0,a.Lk)("div",ie,[(0,a.Lk)("form",{onSubmit:s[3]||(s[3]=(0,o.D$)(((...s)=>e.register&&e.register(...s)),["prevent"]))},[(0,a.Lk)("div",pe,[de,(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":s[0]||(s[0]=s=>e.username=s),type:"text",class:"form-control",id:"username","aria-describedby":"emailHelp"},null,512),[[o.Jo,e.username]]),me]),(0,a.Lk)("div",fe,[ve,(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":s[1]||(s[1]=s=>e.password=s),type:"password",class:"form-control",id:"password"},null,512),[[o.Jo,e.password]]),(0,a.Lk)("div",we,(0,r.v_)(e.err_message),1),ge,(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":s[2]||(s[2]=s=>e.password_confirm=s),type:"password",class:"form-control",id:"password_confirm"},null,512),[[o.Jo,e.password_confirm]])]),ke],32)])])])),_:1})}var be={name:"RegisterView",components:{ContentBase:K},setup:()=>{const e=(0,L.Pj)();let s=(0,ee.KR)(""),t=(0,ee.KR)(""),o=(0,ee.KR)(""),a=(0,ee.KR)("");const n=()=>{a.value="",y().ajax({url:"https://app165.acapp.acwing.com.cn/myspace/user/",type:"POST",data:{username:s.value,password:t.value,password_confirm:o.value},success:o=>{"success"===o.result?e.dispatch("login",{username:s.value,password:t.value,success:()=>{hs.push({name:"UserListView"})},error:()=>{a.value="系统异常, 稍后尝试"}}):a.value=o.result}})};return{username:s,password:t,err_message:a,store:e,password_confirm:o,register:n}}};const he=(0,P.A)(be,[["render",_e],["__scopeId","data-v-2ded7786"]]);var ye=he;const Le=["onClick"],Ce={class:"body-card"},Pe={class:"row"},je={class:"col-1 img-field"},xe=["src"],Ue={class:"col-11"},Ve={class:"username"},Ee={class:"fllowerCount"};function Ae(e,s,t,o,n,l){const c=(0,a.g2)("ContentBase");return(0,a.uX)(),(0,a.Wv)(c,null,{default:(0,a.k6)((()=>[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.users,(s=>((0,a.uX)(),(0,a.CE)("div",{class:"card",key:s.id,onClick:t=>e.open_user_profile(s.id)},[(0,a.Lk)("div",Ce,[(0,a.Lk)("div",Pe,[(0,a.Lk)("div",je,[(0,a.Lk)("img",{class:"img-fluid img-mycss",src:s.photo,alt:""},null,8,xe)]),(0,a.Lk)("div",Ue,[(0,a.Lk)("div",Ve,(0,r.v_)(s.username),1),(0,a.Lk)("div",Ee,(0,r.v_)(s.followerCount),1)])])])],8,Le)))),128))])),_:1})}var Be={name:"UserListView",components:{ContentBase:K},setup:()=>{const e=(0,L.Pj)();let s=(0,ee.KR)([]);y().ajax({url:"https://app165.acapp.acwing.com.cn/myspace/userlist/",type:"get",success(e){s.value=e}});const t=s=>{e.state.user.is_login?hs.push({name:"UserProfileView",params:{userId:s}}):hs.push({name:"LoginView"})};return{users:s,open_user_profile:t}}};const Xe=(0,P.A)(Be,[["render",Ae],["__scopeId","data-v-db169b38"]]);var Oe=Xe;const We={class:"row"},Ie={class:"col-3"},Te={class:"col-9"};function Fe(e,s,t,o,n,r){const l=(0,a.g2)("UserProfileInfo"),c=(0,a.g2)("UserProfileWrite"),u=(0,a.g2)("UserProfilePosts"),i=(0,a.g2)("ContentBase");return(0,a.uX)(),(0,a.Wv)(i,null,{default:(0,a.k6)((()=>[(0,a.Lk)("div",We,[(0,a.Lk)("div",Ie,[(0,a.bF)(l,{onFollow:e.follow,onUnfollow:e.unfollow,user:e.user},null,8,["onFollow","onUnfollow","user"]),e.is_me?((0,a.uX)(),(0,a.Wv)(c,{key:0,onPost_a_post:e.post_a_post},null,8,["onPost_a_post"])):(0,a.Q3)("",!0)]),(0,a.Lk)("div",Te,[(0,a.bF)(u,{user:e.user,posts:e.posts,onDelete_a_post:e.delete_a_post},null,8,["user","posts","onDelete_a_post"])])])])),_:1})}const Ke={class:"card"},Re={class:"car-body"},Se={class:"row"},He={class:"col-3 img-field"},$e=["src"],ze={class:"col-9"},Qe={class:"username"},Je={class:"fans"};function De(e,s,t,o,n,l){return(0,a.uX)(),(0,a.CE)("div",Ke,[(0,a.Lk)("div",Re,[(0,a.Lk)("div",Se,[(0,a.Lk)("div",He,[(0,a.Lk)("img",{class:"img-fluid",src:t.user.photo,alt:""},null,8,$e)]),(0,a.Lk)("div",ze,[(0,a.Lk)("div",Qe,(0,r.v_)(t.user.username),1),(0,a.Lk)("div",Je,"粉丝: "+(0,r.v_)(t.user.followerCount),1),t.user.is_followed?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.CE)("button",{key:0,onClick:s[0]||(s[0]=(...s)=>e.follow&&e.follow(...s)),type:"button",class:"btn btn-primary btn-sm"},"+ 关注")),t.user.is_followed?((0,a.uX)(),(0,a.CE)("button",{key:1,onClick:s[1]||(s[1]=(...s)=>e.unfollow&&e.unfollow(...s)),type:"button",class:"btn btn-primary btn-sm"},"取消关注")):(0,a.Q3)("",!0)])])])])}var Ne={name:"UserProfileInfo",props:{user:{type:Object,required:!0}},setup:(e,s)=>{const t=(0,L.Pj)(),o=()=>{y().ajax({url:"https://app165.acapp.acwing.com.cn/myspace/follow/",type:"POST",data:{target_id:e.user.id},headers:{Authorization:"Bearer "+t.state.user.access},success(e){"success"===e.result&&s.emit("follow")}})},a=()=>{y().ajax({url:"https://app165.acapp.acwing.com.cn/myspace/follow/",type:"POST",data:{target_id:e.user.id},headers:{Authorization:"Bearer "+t.state.user.access},success(e){"success"===e.result&&s.emit("unfollow")}})};return{follow:o,unfollow:a}}};const qe=(0,P.A)(Ne,[["render",De],["__scopeId","data-v-22c51a6c"]]);var Ge=qe;const Me={class:"card"},Ye={class:"body-card"},Ze={class:"card signle-post"},es={class:"body-card"},ss=["onClick"];function ts(e,s,t,o,n,l){return(0,a.uX)(),(0,a.CE)("div",Me,[(0,a.Lk)("div",Ye,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(t.posts.posts,(s=>((0,a.uX)(),(0,a.CE)("div",{key:s.id},[(0,a.Lk)("div",Ze,[(0,a.Lk)("div",es,[(0,a.eW)((0,r.v_)(s.content)+" ",1),e.is_me?((0,a.uX)(),(0,a.CE)("button",{key:0,onClick:t=>e.delete_a_post(s.id),class:"btn btn-danger btn-sm"},"删除",8,ss)):(0,a.Q3)("",!0)])])])))),128))])])}var os={name:"UserProfilePosts",components:{},props:{posts:{type:Object,required:!0},user:{type:Object,required:!0}},setup:(e,s)=>{const t=(0,L.Pj)();let o=(0,a.EW)((()=>t.state.user.id===e.user.id));const n=e=>{y().ajax({url:"https://app165.acapp.acwing.com.cn/myspace/post/",type:"DELETE",data:{post_id:e},headers:{Authorization:"Bearer "+t.state.user.access},success:t=>{"success"===t.result&&s.emit("delete_a_post",e)}})};return{is_me:o,delete_a_post:n}}};const as=(0,P.A)(os,[["render",ts],["__scopeId","data-v-478742e8"]]);var ns=as;const rs=e=>((0,a.Qi)("data-v-1fe85135"),e=e(),(0,a.jt)(),e),ls={class:"card edit-filed"},cs={class:"body-card"},us={class:".edit-filed"},is={class:"form-group"},ps=rs((()=>(0,a.Lk)("label",{for:"edit-post"},"编辑帖子",-1)));function ds(e,s,t,n,r,l){return(0,a.uX)(),(0,a.CE)("div",ls,[(0,a.Lk)("div",cs,[(0,a.Lk)("form",us,[(0,a.Lk)("div",is,[ps,(0,a.bo)((0,a.Lk)("textarea",{"onUpdate:modelValue":s[0]||(s[0]=s=>e.content=s),class:"form-control",id:"edit-post",rows:"3"},null,512),[[o.Jo,e.content]]),(0,a.Lk)("button",{onClick:s[1]||(s[1]=(...s)=>e.post_a_post&&e.post_a_post(...s)),type:"button",class:"btn btn-info btn-sm"},"提交")])])])])}var ms={name:"UserProfileWrite",components:{},setup:(e,s)=>{let t=(0,ee.KR)("");const o=(0,L.Pj)(),a=()=>{y().ajax({url:"https://app165.acapp.acwing.com.cn/myspace/post/",type:"POST",data:{content:t.value},headers:{Authorization:"Bearer "+o.state.user.access},success:e=>{"success"===e.result&&(s.emit("post_a_post",t.value),t.value="")}})};return{content:t,post_a_post:a}}};const fs=(0,P.A)(ms,[["render",ds],["__scopeId","data-v-1fe85135"]]);var vs=fs,ws={name:"UserProfileView",components:{ContentBase:K,UserProfileInfo:Ge,UserProfilePosts:ns,UserProfileWrite:vs},setup:()=>{const e=(0,L.Pj)(),s=(0,A.lq)(),t=parseInt(s.params.userId),o=(0,ee.Kh)({}),n=(0,ee.Kh)({});y().ajax({url:"https://app165.acapp.acwing.com.cn/myspace/getinfo/",type:"GET",data:{user_id:t},headers:{Authorization:"Bearer "+e.state.user.access},success:e=>{o.id=e.id,o.username=e.username,o.photo=e.photo,o.followerCount=e.followerCount,o.is_followed=e.is_followed}}),y().ajax({url:"https://app165.acapp.acwing.com.cn/myspace/post/",type:"GET",data:{user_id:t},headers:{Authorization:"Bearer "+e.state.user.access},success:e=>{n.count=e.length,n.posts=e}});const r=(0,a.EW)((()=>t===e.state.user.id)),l=()=>{o.is_followed||(o.followerCount++,o.is_followed=!0)},c=()=>{o.is_followed&&(o.followerCount--,o.is_followed=!1)},u=e=>{""!==e.value&&(n.count++,n.posts.unshift({id:n.count,userId:1,content:e}))},i=e=>{n.posts=n.posts.filter((s=>s.id!==e)),n.count=n.posts.length};return{user:o,follow:l,unfollow:c,posts:n,post_a_post:u,userId:t,is_me:r,delete_a_post:i}}};const gs=(0,P.A)(ws,[["render",Fe]]);var ks=gs;const _s=[{path:"/",name:"HomeView",component:H},{path:"/404/",name:"NotFindView",component:le},{path:"/login/",name:"LoginView",component:oe},{path:"/register/",name:"RegisterView",component:ye},{path:"/userlist/",name:"UserListView",component:Oe},{path:"/userprofile/:userId/",name:"UserProfileView",component:ks},{path:"/:catchAll(.*)",redirect:"/404/"}],bs=(0,A.aE)({history:(0,A.LA)(),routes:_s});var hs=bs,ys=t(5068);const Ls={state:{id:"",username:"",photo:"",followerCount:0,access:"",refresh:"",is_login:!1},getters:{},mutations:{updateUser:(e,s)=>{e.id=s.id,e.username=s.username,e.photo=s.photo,e.followerCount=s.followerCount,e.access=s.access,e.refresh=s.refresh,e.is_login=s.is_login},updateAccess:(e,s)=>{e.access=s},logout:e=>{e.id="",e.username="",e.photo="",e.followerCount=0,e.access="",e.refresh="",e.is_login=!1}},actions:{login:(e,s)=>{y().ajax({url:"https://app165.acapp.acwing.com.cn/api/token/",type:"POST",data:{username:s.username,password:s.password},success(t){const{access:o,refresh:a}=t,n=(0,ys.s)(o);setInterval((()=>{y().ajax({url:"https://app165.acapp.acwing.com.cn/api/token/refresh/",type:"POST",data:{refresh:a},success:()=>{e.commit("updateAccess",t.access)}})}),27e4),y().ajax({url:"https://app165.acapp.acwing.com.cn/myspace/getinfo/",type:"GET",data:{user_id:n.user_id},headers:{Authorization:"Bearer "+o},success(t){e.commit("updateUser",{...t,access:o,refresh:a,is_login:!0}),s.success()}})},error:()=>{s.error()}})}},modules:{}};var Cs=Ls,Ps=(0,L.y$)({state:{},getters:{},mutations:{},actions:{},modules:{user:Cs}});(0,o.Ef)(E).use(Ps).use(hs).mount("#app")}},s={};function t(o){var a=s[o];if(void 0!==a)return a.exports;var n=s[o]={exports:{}};return e[o].call(n.exports,n,n.exports,t),n.exports}t.m=e,function(){var e=[];t.O=function(s,o,a,n){if(!o){var r=1/0;for(i=0;i<e.length;i++){o=e[i][0],a=e[i][1],n=e[i][2];for(var l=!0,c=0;c<o.length;c++)(!1&n||r>=n)&&Object.keys(t.O).every((function(e){return t.O[e](o[c])}))?o.splice(c--,1):(l=!1,n<r&&(r=n));if(l){e.splice(i--,1);var u=a();void 0!==u&&(s=u)}}return s}n=n||0;for(var i=e.length;i>0&&e[i-1][2]>n;i--)e[i]=e[i-1];e[i]=[o,a,n]}}(),function(){t.n=function(e){var s=e&&e.__esModule?function(){return e["default"]}:function(){return e};return t.d(s,{a:s}),s}}(),function(){t.d=function(e,s){for(var o in s)t.o(s,o)&&!t.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:s[o]})}}(),function(){t.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){t.o=function(e,s){return Object.prototype.hasOwnProperty.call(e,s)}}(),function(){t.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={524:0};t.O.j=function(s){return 0===e[s]};var s=function(s,o){var a,n,r=o[0],l=o[1],c=o[2],u=0;if(r.some((function(s){return 0!==e[s]}))){for(a in l)t.o(l,a)&&(t.m[a]=l[a]);if(c)var i=c(t)}for(s&&s(o);u<r.length;u++)n=r[u],t.o(e,n)&&e[n]&&e[n][0](),e[n]=0;return t.O(i)},o=self["webpackChunkmyspace"]=self["webpackChunkmyspace"]||[];o.forEach(s.bind(null,0)),o.push=s.bind(null,o.push.bind(o))}();var o=t.O(void 0,[504],(function(){return t(5988)}));o=t.O(o)})();
//# sourceMappingURL=app.23f295df.js.map